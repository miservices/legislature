<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Legislative Bills</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
:root{
    --primary:#0b3c5d;
    --secondary:#1d6fa5;
    --accent:#e0b400;
    --light:#f4f6f8;
    --dark:#1a1a1a;
    --muted:#6b7280;
}

*{box-sizing:border-box;margin:0;padding:0;font-family:"Segoe UI",Arial,sans-serif}
body{background:var(--light);color:var(--dark);line-height:1.6}

/* HEADER */
header{
    background:linear-gradient(135deg,var(--primary),var(--secondary));
    color:#fff;
    padding:1.25rem 2rem;
}
.header-inner{
    max-width:1200px;margin:auto;
    display:flex;justify-content:space-between;align-items:center;
}
.logo{font-size:1.6rem;font-weight:700}
nav a{
    color:#ffffffcc;text-decoration:none;
    margin-left:1.5rem;font-weight:500;
}
nav a.active{
    color:#fff;font-weight:700;
    border-bottom:3px solid var(--accent);
    padding-bottom:6px;
}

/* HERO */
.hero{
    background:linear-gradient(rgba(11,60,93,0.85),rgba(11,60,93,0.85)),
    url("https://upload.wikimedia.org/wikipedia/commons/8/88/Michigan_State_Capitol_exterior.jpg")
    center/cover no-repeat;
    color:#fff;padding:6rem 2rem;
}
.hero-inner{max-width:900px;margin:auto}
.hero h1{font-size:3rem;margin-bottom:1rem}

/* FILTER */
.filter-bar{
    max-width:1200px;margin:2rem auto;
    padding:0 2rem;
}
.filter-bar input{
    padding:10px 14px;border-radius:8px;
    border:1px solid #ccc;width:100%;max-width:350px;
}

/* RESULTS */
.results-wrapper{
    max-width:1200px;margin:auto;
    padding:0 2rem 3rem 2rem;
}

.bill-row{
    background:#fff;padding:1.5rem;
    border-radius:12px;margin-bottom:1rem;
    box-shadow:0 8px 20px rgba(0,0,0,0.06);
    cursor:pointer;transition:0.2s;
}
.bill-row:hover{
    transform:translateY(-3px);
    box-shadow:0 12px 28px rgba(0,0,0,0.1);
}
.bill-row.active{
    border:2px solid var(--secondary);
}

.bill-top{
    display:flex;justify-content:space-between;
    margin-bottom:0.5rem;
}
.bill-id{
    font-weight:700;color:var(--primary);
    font-size:1rem;
}
.badge{
    background:var(--secondary);color:#fff;
    padding:4px 10px;border-radius:999px;
    font-size:12px;
}
.bill-title{font-weight:600;margin-bottom:4px}
.bill-desc{color:var(--muted);font-size:0.9rem}

/* DETAIL */
.detail-section{
    margin-top:2rem;background:#fff;
    padding:2rem;border-radius:12px;
    box-shadow:0 10px 30px rgba(0,0,0,0.08);
    display:none;position:relative;
}
.detail-section.active{display:block;animation:fadeIn .25s ease}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}

.close-btn{
    position:absolute;top:20px;right:20px;
    cursor:pointer;font-weight:600;color:var(--muted);
}

.detail-number{
    font-size:1.4rem;font-weight:700;
    color:var(--primary);
}
.detail-name{
    font-size:1.1rem;font-weight:600;
    margin-top:4px;margin-bottom:1rem;
}

.detail-meta{
    display:flex;gap:2.5rem;
    margin-bottom:1.5rem;
    font-weight:600;color:var(--secondary);
}
.detail-description{margin-bottom:1.5rem}

/* DOCUMENTS */
.documents a{
    display:block;margin-bottom:6px;
    font-weight:600;color:var(--secondary);
    text-decoration:none;
}
.documents a:hover{text-decoration:underline}

/* TIMELINE */
.timeline{
    margin-top:1rem;
    border-left:3px solid #e5e7eb;
    padding-left:35px;
}
.timeline-item{
    margin-bottom:18px;
    position:relative;
}
.timeline-item::before{
    content:"";
    position:absolute;
    left:-23px;top:6px;
    width:12px;height:12px;
    border-radius:50%;
    background:#cbd5e1;
}
.timeline-item.recent::before{
    background:var(--secondary);
    box-shadow:0 0 0 4px rgba(29,111,165,0.15);
}

footer{
    background:var(--primary);
    color:#fff;padding:2rem;
    margin-top:3rem;text-align:center;
}
</style>
</head>

<body>

<header>
<div class="header-inner">
<div class="logo">Michigan Legislature</div>
<nav>
<a href="https://miservices.github.io/legislature/">Home</a>
<a href="https://miservices.github.io/legislature/about">About</a>
<a href="https://miservices.github.io/legislature/mcl">Laws</a>
<a href="https://miservices.github.io/legislature/bills" class="active">Bills</a>
<a href="https://miservices.github.io/legislature/resolutions">Resolutions</a>
<a href="https://miservices.github.io/legislature/journals">Journals</a>
</nav>
</div>
</header>

<section class="hero">
<div class="hero-inner">
<h1>Legislative Bills</h1>
<p>Search and explore legislation introduced in the Michigan Legislature.</p>
</div>
</section>

<div class="filter-bar">
<input id="search" placeholder="Search bills..." oninput="applyFilters()">
</div>

<div class="results-wrapper">
<div id="results"></div>
<div id="detailSection" class="detail-section"></div>
</div>

<footer>© 2026 Michigan Legislature</footer>

<script>
let billsData=[];
const CSV_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vQ31EfUU7mCQYrcQAhNTKXey6ep6f6rACOykAkPa2FIfQtAN3iRgPxumI-3AdcyYKZUVoIpuI0NDnJL/pub?gid=0&single=true&output=csv";

document.addEventListener("DOMContentLoaded",()=>{
Papa.parse(CSV_URL,{
download:true,header:true,skipEmptyLines:true,
complete:res=>{
billsData=res.data.filter(b=>b["Bill No"]);
renderResults(billsData);
handleHash();
}
});
window.addEventListener("hashchange",handleHash);
});

function normalizeId(text){
return text.toLowerCase().replace(/\s+/g,'');
}

function formatNumber(b){
const status=(b["Status"]||"").toLowerCase();
if((status.includes("enacted")||status.includes("repealed"))&&b["PA No"])
return `PA ${b["PA No"]} | ${b["Bill No"]}`;
return b["Bill No"];
}

function applyFilters(){
const q=document.getElementById("search").value.toLowerCase();
renderResults(billsData.filter(b=>
(b["Bill No"]+b["Name"]+b["Description"]).toLowerCase().includes(q)
));
}

function renderResults(data){
const container=document.getElementById("results");
container.innerHTML="";
data.forEach(b=>{
const row=document.createElement("div");
row.className="bill-row";
row.onclick=()=>location.hash=normalizeId(b["Bill No"]);
row.dataset.id=normalizeId(b["Bill No"]);
row.innerHTML=`
<div class="bill-top">
<div class="bill-id">${formatNumber(b)}</div>
<div class="badge">${b["Status"]||"—"}</div>
</div>
<div class="bill-title">${b["Name"]||""}</div>
<div class="bill-desc">${b["Description"]||""}</div>
`;
container.appendChild(row);
});
}

function handleHash(){
const id=location.hash.replace("#","");
if(!id) return;
const bill=billsData.find(b=>normalizeId(b["Bill No"])===id);
if(bill) showDetail(bill);
}

function showDetail(b){
document.querySelectorAll(".bill-row").forEach(r=>r.classList.remove("active"));
const active=document.querySelector(`[data-id="${normalizeId(b["Bill No"])}"]`);
if(active) active.classList.add("active");

const section=document.getElementById("detailSection");
const history=b["History"]?b["History"].split("|").map(h=>h.trim()).filter(Boolean):[];

section.innerHTML=`
<div class="close-btn" onclick="closeDetail()">Close</div>

<div class="detail-number">${formatNumber(b)}</div>
<div class="detail-name">${b["Name"]||""}</div>

<div class="detail-meta">
<div>${b["Status"]||"—"}</div>
<div>${b["Intro Chamber"]||"—"}</div>
<div>${b["Sponsors"]||"—"}</div>
</div>

<div class="detail-description">${b["Description"]||""}</div>

<h3>Documents</h3>
<div class="documents">
${renderDocs(b)}
</div>

<h3 style="margin-top:2rem;">Legislative Timeline</h3>
<div class="timeline">
${history.length?history.map((h,i)=>`
<div class="timeline-item ${i===history.length-1?"recent":""}">${h}</div>
`).join(""):"No history available."}
</div>
`;

section.classList.add("active");
section.scrollIntoView({behavior:"smooth"});
}

function renderDocs(b){
const links=[];
if(b["Intro PDF"]) links.push(`<a href="${b["Intro PDF"]}" target="_blank">Introduced Bill.pdf</a>`);
if(b["Concurred PDF"]) links.push(`<a href="${b["Concurred PDF"]}" target="_blank">Concurred Bill.pdf</a>`);
if(b["PA PDF"]) links.push(`<a href="${b["PA PDF"]}" target="_blank">Public Act.pdf</a>`);
return links.length?links.join(""):"No documents available.";
}

function closeDetail(){
document.getElementById("detailSection").classList.remove("active");
history.pushState("",document.title,window.location.pathname+window.location.search);
}
</script>

</body>
</html>
